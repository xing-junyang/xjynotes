# 贝叶斯分类器

贝叶斯分类器是一种基于生成式模型的分类器，其基本思想是利用**贝叶斯公式**计算后验概率 $p(y|\mathbf{x})$，然后选择使得后验概率最大的类别作为预测结果。

::: tip 两种机器学习的策略

机器学习所要实现的目标在某种程度上可以视作利用有限的样本进行学习，以达到给定输入 $\mathbf{x}$，尽可能准确地预测后验概率 $p(y|\mathbf{x})$ 的目标。由于 $p(y|\mathbf{x})$ 是未知的，因此主要有两种策略：

- **判别式模型**：直接对 $p(y|\mathbf{x})$ 进行建模，例如**决策树、支持向量机、神经网络**等。
- **生成式模型**：对联合分布 $p(\mathbf{x},y)$ 进行建模，然后通过贝叶斯公式计算后验概率 $p(y|\mathbf{x})$。

:::

## 贝叶斯公式

给定样本 $\mathbf{x}$ 和类别 $c$，贝叶斯公式为：

$$
p(c|\mathbf{x}) = \frac{p(\mathbf{x}|c)p(c)}{p(\mathbf{x})}
$$

其中 $p(c|\mathbf{x})$ 是后验概率，也是我们的**目标**；$p(\mathbf{x}|c)$ 是似然度，表示在类别 $c$ 下样本 $\mathbf{x}$ 出现的概率；$p(c)$ 是先验概率，表示类别 $c$ 出现的概率；$p(\mathbf{x})$ 是证据因子，是与类别无关的**因子**。

## 极大似然估计

在实际应用中，我们通常先假设似然 $P(\mathbf{x}|c)$ 有**某种概率的分布形式**（这种分布形式带有参数，而概率分布可被参数 $\mathbf{\theta}_c$ 唯一确定），然后再根据训练样例**对参数进行估计**。

$\mathbf{\theta}_c$ 对于训练集 $\mathcal{D}$ 中的类别 $c$，可以通过**极大似然估计**得到：

$$
P(D_c|\mathbf{\theta}_c) = \prod_{i=1}^{N}P(\mathbf{x}_i|c,\mathbf{\theta}_c)
$$

一般使用**对数似然**来简化计算并**避免数值下溢**：

$$
\mathbf{\theta}_c = \arg\max_{\mathbf{\theta}}\log P(D_c|\mathbf{\theta}_c)
$$

例如，如果假设 $P(\mathbf{x}|c)$ 服从**高斯分布**，即 $P(\mathbf{x}|c) \sim \mathcal{N}(\mathbf{\mu}_c,\mathbf{\Sigma}^2_c)$，则可以通过**最大似然估计**得到（其中 $N$ 为训练集中类别 $c$ 的样本数）：

$$
\begin{aligned}
\hat{\mathbf{\mu}}_c &= \frac{1}{N}\sum_{i=1}^{N}\mathbf{x}_i\\
\hat{\mathbf{\sigma}}_c &= \frac{1}{N}\sum_{i=1}^{N}(\mathbf{x}_i-\hat{\mathbf{\mu}}_c)(\mathbf{x}_i-\hat{\mathbf{\mu}}_c)^T
\end{aligned}
$$

显然，估计结果的准确性严重依赖于所假设的概率分布形式是否符合潜在的真实分布。上述的例子中，如果真实的分布不是高斯分布，那么使用高斯分布来估计参数会导致**欠拟合**。

## 朴素贝叶斯分类器

朴素贝叶斯分类器是一种**简单**的贝叶斯分类器，其**朴素**体现在**特征之间相互独立**的假设上。在这一假设下，我们有

$$
p(c|\mathbf{x}) = \frac{p(c)p(\mathbf{x}|c)}{p(\mathbf{x})} = \frac{p(c)\prod_{i=1}^{n}p(x_i|c)}{p(\mathbf{x})}
$$

其中 $n$ 为特征的数量，$x_i$ 为 $\mathbf{x}$ 在第 $i$ 个属性上的取值。这样，我们可以通过计算 $p(c)\prod_{i=1}^{n}p(x_i|c)$ 来选择**使得后验概率最大的类别**作为预测结果。

对于 $p(\mathbf{x}|c)$ 的估计，我们可以使用**最大似然估计**来估计参数。例如，如果特征 $x_i$ 是**离散**的，那么可以简单地估计

$$
p(x_i|c) = \frac{|D_{c,x_i}|}{|D_c|}
$$

其中 $D_{c,x_i}$ 表示类别 $c$ 中属性 $i$ 取值为 $x_i$ 的样本集合，$D_c$ 表示类别 $c$ 的样本集合。

如果特征 $x_i$ 是**连续**的，那么可以假设 $p(x_i|c)$ 服从**高斯分布**，然后通过**最大似然估计**得到参数。

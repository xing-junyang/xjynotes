# 嵌入式开发简述

::: tip Why Embedded

> 预见未来的最好方式就是亲手创造未来。
>
> 对待软件严肃认真的人，也应该创造自己的硬件。
>
> ——$\mathrm{Alan~Kay~(1940-)}$

:::

## 嵌入式系统的概念

嵌入式系统一般即指嵌入式计算机系统。后 $\mathrm{PC}$ 时代是一个互联网嵌入式的时代。

嵌入式系统是：**已应用为中心，以计算机技术为基础，软硬件可以裁剪，适用于应用系统对功能、可靠性、成本、体积、功耗有严格要求的专用计算机系统。**

嵌入式系统的三要素：**嵌入性**（嵌入到对象体系中，有对象环境要求）、**专用性**（软、硬件按需裁减）和**计算机**（智能设备）。

嵌入式的核心愿景是：**去除冗余，硬件和软件有机结合**。

### 术语演化——几个预见

- **泛在计算**：任何时间地点的计算
- **不可见计算机**：集成在物件之中的计算机
- **普适计算**：计算设备在日常生活中的渗透
- **环境智能**：未来楼宇或家庭场景中的智能通信技术

### CPS

信息物理系统（$\mathrm{Cyber-Physical~System}$）是计算进程和物理进程的集成，更多强调物理模块的集合。

**通信**与**嵌入式**系统互联协同，提供普适、泛在的计算资源。

### 无线感知网络

许多在空间分布的自动装置构成的**无线计算机网络**，协作监控环境的物理情况。

起源于军用，后来渐渐民用化，常用于生态监测、健康监护和家具自动化等。

### 物联网

通过射频识别、红外感应器、$\mathrm{GPS}$​、激光扫描器等，进行信息交换和通信，来实现**智能化识别、定位、跟踪、监控和管理**等。物联网是互联网的扩充，实现各个时间地点的人机物互通。

## 嵌入式开发的目标与定位

- 嵌入式软件开发
  - 产品增值
  - 产品越来越复杂
    - 绝大多数软件是嵌入的
    - 新型汽车、战斗机等场景应用广泛
  - $\mathrm{DIY}$
- 系统开发

## 嵌入式系统介绍

### 嵌入式系统的组成

嵌入式处理器、存储器和外部设备构成了系统的硬件基础。系统软件、应用支撑软件和应用软件构成了软件基础。

### 通用计算机和嵌入式系统的区别

- 嵌入式系统硬件结合相对**紧密**，而通用计算机则相对独立；
- 计算模型不同，通用计算机为冯诺依曼模型，而嵌入式系统则有**许多模型**；
- 嵌入式系统偏重特殊的**优化**目标，通用计算机更偏重平均性能；
- 嵌入式系统**二次开发性较弱**，但一般设计时**应用已知**。

### 嵌入式系统应用

嵌入式系统无处不在，例如，现已应用在：

- **运输和移动性**：智能汽车（包括传统的汽车电子控制，还有新兴的智驾）、航电设备、铁路设备、海事设备等；
- **工厂自动化**；
- **适居性**：智能楼宇、智能家居、健康监测等；
- **电子产品**：智能穿戴设备、新概念产品等；
- **军事、农业、畜牧业**；
- **灾难恢复、公共安全**等。

### 嵌入式系统的特征

**形式多样、面向特定的应用**：软硬件高效设计、可剪裁；多种类型的处理器和处理器体系结构；集成度高、功耗和体积较小。

**高度制约的环境**：环境通常较为恶劣、不友好；受到处理器容量和用户接口的限制。

**与外部环境高度交互**：无人干预下对外部环境交互；利用传感器来收集外部环境的数据，通过执行器来控制外部环境。

**实时性要求**：嵌入式系统多有实时性的要求，具有时间约束条件；实时嵌入式系统通常包括实时控制。例如：飞行器、医疗设备等都有强实时性的约束。

**安全性和可靠性要求**：某些嵌入式系统必须以安全至上并且具有高度可靠性。例如：配备在汽车上的安全气囊。很多嵌入式系统有硬件机制来保障，如看门狗锁等。

**关注成本**：如量大的消费类数字化产品，其成本是产品竞争的关键因素之一。

### 嵌入式系统的分类

按**处理器位数**分：

- $4/8/16$ 位处理器：现已广泛应用
- $32$ 位处理器：主流应用
- $64$ 位处理器

按**应用场景**分类

按**速度**分类：

- 强实时系统：系统响应等级在毫秒或微秒级。
- 实时系统
- 弱实时系统：系统响应时间不满足也可以。

此外，硬实时系统和软事实系统刻画了系统实时性的重要性。

### 嵌入式系统的发展趋势

- 嵌入式人工智能
- 不断增加算力和复杂性、云和边缘计算
- 互通互联的需求增加
- 集成度增加

### 嵌入式系统硬件

##### 处理器

- $\mathrm{ARM}$
- $\mathrm{MIPS}$
- $\mathrm{PowerPC}$
- $\mathrm{x}86$

##### 计算机结构

- 冯诺依曼结构
- **哈佛结构**：使用两个独立的存储器模块，分别存储指令和数据，同时分配两条独立的总线，每个存储模块都不允许指令和数据并存；

##### 编程模型

- 程序中可以用到的寄存器集合。某些寄存器保留不可见。

##### 嵌入式微处理单元

- $\mathrm{MPU}$：类似通用 $\mathrm{CPU}$。
- $\mathrm{MCU}$： 将整个计算机系统的主要硬件集成到一块芯片之中，芯片内一般会集成 $\mathrm{ROM}$、内存、总线、定时器、$\mathrm{I/O}$​ 等外设。
- $\mathrm{DSP}$：**专门用于信号处理的处理器**，其在系统结构和指令算 法方面进行了特殊设计，具有很高的编译效率和指令执行速度。
- $\mathrm{SoC}$：追求产品系统最大包容的集成器件。

##### 现场可编程门阵列 $\mathrm{FPGA}$

- 具有可编程特性的集成电路
- 属于一种半定制电路
- 用硬件实现数据处理，定制化特别高
- 但是不能处理多事件

::: tip 选择微处理器的准则

- 高效、经济地满足任务的计算需求
- 软件开发工具的可用性
- 广泛的可用性和微处理器来源

:::

::: tip $\mathrm{ARM}$ 处理器

采用典型的 $\mathrm{RISC}$ 架构，具有丰富的寄存器、简单寻址模式和统一长度的指令字段。增强功能有每条指令包括移位器的操作和条件执行。特点是**高性能、低代码量、低功耗和低硅面积**。

:::

## 物联网设备分类

- 高端设备，如车载；
- 中端设备，包括单板机和手机；
- 低级物联网设备，资源有限，如 $\mathrm{Arduino}$ 等。